jQuery.magicCanvas={reqId:0,draw:function(H){function C(){h=document.getElementById("reactive-bg-canvas");m=$(window).width();p=$(window).height();h.style.position="fixed";h.style.zIndex=g.zIndex;h.style.top="0px";h.style.left="0px";h.width=m;h.height=p;q={x:m/2,y:p/2,rx:m/2,ry:p/2};n=h.getContext("2d");if("random-move"==g.type){d=[];for(var a=0;m>a;a+=m/20)for(var b=0;p>b;b+=p/20){var c=a+Math.random()*m/20,k=b+Math.random()*p/20,c={x:c,originX:c,y:k,originY:k};d.push(c)}for(a=0;a<d.length;a++){c=
[];b=d[a];for(k=0;k<d.length;k++){var f=d[k];if(b!=f){for(var t=!1,r=0;5>r;r++)t||void 0==c[r]&&(c[r]=f,t=!0);for(r=0;5>r;r++)t||v(b,f)<v(b,c[r])&&(c[r]=f,t=!0)}}b.closest=c}for(a=0;a<d.length;a++)d[a].circle=new y(d[a],2+2*Math.random(),void 0)}else if("heart-beat"==g.type){a={x:m/2,y:p/2,closest:[]};b=[e(a,"left"),e(a,"rightTop"),e(a,"rightBottom")];for(d=[a];0<b.length;)if(c=b.pop(),0<c.x&&c.x<m&&0<c.y&&c.y<p){k=!1;for(a=0;a<d.length;a++)if(v(c,d[a])<.1*Math.pow(g.lineLen,2)){k=!0;break}k||(d.push(c),
a=c.type,"leftTop"==a||"leftBottom"==a?(b.unshift(e(c,"left")),b.unshift(e(c,"leftTop"==a?"rightTop":"rightBottom"))):"rightTop"==a||"rightBottom"==a?(b.unshift(e(c,"right")),b.unshift(e(c,"rightTop"==a?"leftTop":"leftBottom"))):"left"==a?(b.unshift(e(c,"leftBottom")),b.unshift(e(c,"leftTop"))):"right"==a&&(b.unshift(e(c,"rightBottom")),b.unshift(e(c,"rightTop"))))}for(a=0;a<d.length;a++)d[a].circle=new y(d[a],2)}}function I(a){a.pageX||a.pageY?(q.x=a.pageX,q.y=a.pageY):(a.clientX||a.clientY)&&(q.x=
a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,q.y=a.clientY+document.body.scrollTop+document.documentElement.scrollTop);q.rx=a.clientX;q.ry=a.clientY}function D(){if(this.reqId&&E(this.reqId),"heart-beat"==g.type)setInterval(J,g.heartBeatCD);else if("random-move"==g.type){x();for(var a=0;a<d.length;a++)F(d[a])}}function x(){if(n.clearRect(0,0,m,p),"heart-beat"==g.type){for(var a=0,b=0;b<t.length;b++){var c=t[b];0<c.circle.active?(c.circle.active-=.012,c.circle.draw()):a++}if(0<
t.length&&a==t.length)return void(t=[])}else if("random-move"==g.type)for(a=A(),b=0;b<d.length;b++){4E3>Math.abs(v(a,d[b]))?(d[b].active=.3,d[b].circle.active=.6):2E4>Math.abs(v(a,d[b]))?(d[b].active=.1,d[b].circle.active=.3):4E4>Math.abs(v(a,d[b]))?(d[b].active=.02,d[b].circle.active=.1):(d[b].active=0,d[b].circle.active=0);c=d[b];if(c.active)for(var k=0;k<c.closest.length;k++){n.beginPath();n.moveTo(c.x,c.y);n.lineTo(c.closest[k].x,c.closest[k].y);var f="function"==typeof g.rgb?g.rgb(q):g.rgb,f=
"".concat(f.r).concat(",").concat(f.g).concat(",").concat(f.b);n.strokeStyle="rgba("+f+","+c.active+")";n.stroke()}d[b].circle.draw()}this.reqId=requestAnimationFrame(x)}function J(){x();var a=K(),b=new y(a,0),c=g.heartBeatRange/144,k=2400/144,f=.8,q=A();t=[];var r=function(){if(b.radius<g.heartBeatRange){for(var a=0;a<d.length;a++){var m=d[a];if(v(m,b.pos)<Math.pow(b.radius,2))for(var p=0;p<m.closest.length;p++){var l;l=m;var n=m.closest[p],e=b,u=v(l,e.pos),h=v(n,e.pos),w=Math.sqrt(Math.max(u,h));
if(Math.sqrt(Math.min(u,h))<e.radius&&w>e.radius){var u=(l.y-n.y)/(l.x-n.x),h=l.y-u*l.x,w=-e.pos.x,z=-e.pos.y,x=(Math.pow(u,2)+1)*Math.pow(e.radius,2)-Math.pow(w*u,2)+2*(w*z+h*w)*u-Math.pow(z+h,2),e=(-1*Math.sqrt(x)-u*(z+h)-w)/(Math.pow(u,2)+1),w=(Math.sqrt(x)-u*(z+h)-w)/(Math.pow(u,2)+1);l=e<Math.max(l.x,n.x)&&e>Math.min(l.x,n.x)?e:w;l={x:l,y:u*l+h}}else l=void 0;void 0!=l&&(l.circle=new y(l,1.2,q),l.circle.active=f,f*=.999,t.push(l))}}setTimeout(r,k);b.radius+=c}};B&&r()}function F(a){TweenLite.to(a,
1+Math.random(),{x:a.originX-50+100*Math.random(),y:a.originY-50+100*Math.random(),onComplete:function(){F(a)}})}function K(){for(var a={x:-100,y:-100},b=A(),c=0;c<d.length;c++)var k=d[c],a=v(b,k)<v(b,a)?k:a;return a}function e(a,b){var c=g.lineLen*Math.sin(60*Math.PI/180),d=g.lineLen*Math.cos(60*Math.PI/180),f={closest:[]};return"left"==b||"right"==b?(f.x=a.x+g.lineLen*("left"==b?-1:1),f.y=a.y):"rightTop"==b||"rightBottom"==b?(f.x=a.x+d,f.y=a.y+c*("rightTop"==b?-1:1)):("leftTop"==b||"leftBottom"==
b)&&(f.x=a.x-d,f.y=a.y+c*("leftTop"==b?-1:1)),f.type=b,a.closest.push(f),f.closest.push(a),f}function y(a,b,c){this.pos=a||null;this.radius=b||null;this.centerP=c;this.draw=function(){if(this.active){n.beginPath();n.arc(this.pos.x,this.pos.y,this.radius,0,2*Math.PI,!1);var a="function"==typeof g.rgb?g.rgb(this.pos,this.centerP||this.pos):g.rgb,a="".concat(a.r).concat(",").concat(a.g).concat(",").concat(a.b);n.fillStyle="rgba("+a+","+this.active+")";n.fill()}}}function v(a,b){return Math.pow(a.x-b.x,
2)+Math.pow(a.y-b.y,2)}function A(){var a=q.x-G.offset().left,b=q.y-G.offset().top;return{x:a,y:b}}function E(a){for(var b=0,c=["ms","moz","webkit","o"],d=0;d<c.length&&!window.requestAnimationFrame;++d)window.requestAnimationFrame=window[c[d]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[c[d]+"CancelAnimationFrame"]||window[c[d]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(a,c){var d=(new Date).getTime(),e=Math.max(0,16-(d-b)),
g=window.setTimeout(function(){a(d+e)},e);return b=d+e,g});window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)});a&&window.cancelAnimationFrame(a)}E();var m,p,h,n,d,q,B=!0,t=[],G=$("#reactive-bg-canvas"),g=$.extend({lineLen:30,heartBeatCD:3E3,heartBeatRange:300,rgb:{r:156,g:217,b:249},type:"heart-beat",zIndex:-99999},H);$(document).mouseenter(function(){B=!0});$(document).mouseleave(function(){B=!1});C();D();"ontouchstart"in window||window.addEventListener("mousemove",
I);window.addEventListener("scroll",function(){q.x=q.rx+document.body.scrollLeft+document.documentElement.scrollLeft;q.y=q.ry+document.body.scrollTop+document.documentElement.scrollTop});window.addEventListener("resize",function(){m=window.innerWidth;p=window.innerHeight;h.width=m;h.height=p;this.reqId&&window.cancelAnimationFrame(this.reqId);C();D()})}};
